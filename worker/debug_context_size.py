import chromadb

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ChromaDB
client = chromadb.HttpClient(host='chromadb', port=8000)
collection = client.get_collection("documents")

# –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞–Ω–∫–∞ 0 (–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ—Ö–æ–¥–∏—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é)
chunk_0 = collection.get(
    where={"chunk_index": 0},
    include=["documents", "metadatas"]
)

if chunk_0['documents']:
    content = chunk_0['documents'][0]
    
    print("=== –ê–ù–ê–õ–ò–ó –†–ê–ó–ú–ï–†–ê –ö–û–ù–¢–ï–ö–°–¢–ê ===")
    print(f"–î–ª–∏–Ω–∞ —á–∞–Ω–∫–∞ 0: {len(content)} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤: {len(content) // 4} —Ç–æ–∫–µ–Ω–æ–≤")  # –ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ 4 —Å–∏–º–≤–æ–ª–∞ = 1 —Ç–æ–∫–µ–Ω
    
    # –ü—Ä–æ–≤–µ—Ä–∏–º —á—Ç–æ –∏–º–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ LLM
    context_for_llm = f"[–ò—Å—Ç–æ—á–Ω–∏–∫ 1: –ü—Ä–∏–∫–∞–∑_–æ–±_–∏–∑–º–µ–Ω–µ–Ω–∏–∏_–¥–æ–ª–∂–Ω–æ—Å—Ç–Ω–æ–π_–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏_–∫–æ–ø–∏—Ä–∞–π—Ç–µ—Ä–∞]\n{content}\n"
    
    print(f"\n–ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è LLM:")
    print(f"–î–ª–∏–Ω–∞: {len(context_for_llm)} —Å–∏–º–≤–æ–ª–æ–≤")
    print(f"–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤: {len(context_for_llm) // 4} —Ç–æ–∫–µ–Ω–æ–≤")
    
    print(f"\n–ü–µ—Ä–≤—ã–µ 300 —Å–∏–º–≤–æ–ª–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:")
    print(context_for_llm[:300])
    print("...")
    print(f"\n–ü–æ—Å–ª–µ–¥–Ω–∏–µ 300 —Å–∏–º–≤–æ–ª–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:")
    print(context_for_llm[-300:])
    
    # –ü—Ä–æ–≤–µ—Ä–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ chunking
    print(f"\n=== –ù–ê–°–¢–†–û–ô–ö–ò CHUNKING ===")
    print("–ò–∑ chunking_service.py:")
    print("CHUNK_SIZE = 1000")
    print("CHUNK_OVERLAP = 100") 
    print("MIN_CHUNK_SIZE = 200")
    
    print(f"\n=== –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò ===")
    if len(content) > 800:
        print("‚ö†Ô∏è  –ß–∞–Ω–∫ –±–æ–ª—å—à–æ–π (>800 —Å–∏–º–≤–æ–ª–æ–≤)")
        print("üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –£–º–µ–Ω—å—à–∏—Ç—å CHUNK_SIZE –¥–æ 600-800")
    else:
        print("‚úÖ –†–∞–∑–º–µ—Ä —á–∞–Ω–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π")
        
    if len(context_for_llm) > 2000:
        print("‚ö†Ô∏è  –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è LLM –±–æ–ª—å—à–æ–π (>2000 —Å–∏–º–≤–æ–ª–æ–≤)")
        print("üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û–±—Ä–µ–∑–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ 1500 —Å–∏–º–≤–æ–ª–æ–≤")
    else:
        print("‚úÖ –†–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è LLM –ø—Ä–∏–µ–º–ª–µ–º—ã–π")

else:
    print("–ß–∞–Ω–∫ 0 –Ω–µ –Ω–∞–π–¥–µ–Ω")
